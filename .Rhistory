ESTADO==1 & CAT_OCUP== 3 & JERARQUIA==3 & CALIFICACION==4 ~  "Obrero NC",
ESTADO==1 & CAT_OCUP==2 & (NIVEL_ED==6 | NIVEL_ED==5) ~ "CP_calif",
ESTADO==1 & CAT_OCUP==2 & NIVEL_ED!=6 | NIVEL_ED!=5 ~ "CP_no_calif",
ESTADO==1 & CAT_OCUP== 1 ~ "Patron",
TRUE ~ "Otro"
))->base
base %>%  mutate(INF = case_when(
PP04C<6 & d5>1 & d5<6 & CAT_OCUP== 1  ~  "Patron INF",
PP04C>5 & (d5<1 | d5>=6) & CAT_OCUP== 1  ~  "Patron formal",
PP04C<6 & d5>1 & d5<6 & CAT_OCUP== 2  ~  "CP INF",
PP04C>5 & (d5<1 | d5>=6) & CAT_OCUP== 2  ~  "CP formal",
CAT_OCUP== 3 & PP07H==2 &  PP04C>5 & PP04B1==2  ~  "inf_for",
CAT_OCUP== 3 & PP07H==2 &  PP04C<6 & PP04B1==2 ~ "inf_inf",
CAT_OCUP== 3 & PP07H==2 & PP04B1==1 ~ "inf_hog",
CAT_OCUP== 3 & PP07H==1 & PP04B1==1 ~ "form_hog",
CAT_OCUP== 3 & PP07H==1 &  PP04C>5 & PP04B1==2   ~ "form_form",
CAT_OCUP== 3 & PP07H==1 &  PP04C<6 & PP04B1==2   ~ "form_inf"
))->base
base$CH03<-as.factor(base$CH03)
base$CAT_OCUP<-as.factor(base$CAT_OCUP)
base$NIVEL_ED<-as.factor(base$NIVEL_ED)
base$CH04<-as.factor(base$CH04)
base$AGLOMERADO<-as.factor(base$AGLOMERADO)
base$REGION<-as.factor(base$REGION)
base$INF<-as.factor(base$INF)
base$rol<-as.factor(base$rol)
base$PP04C<-as.factor(base$PP04C)
# base$CH06<-(base$CH06-min(base$CH06))/(max(base$CH06)- min(base$CH06))
base$TECNO<-substr(base$PP04D_COD,4,4)
base$car1<-substr(base$PP04D_COD,1,1)
base$car2<-substr(base$PP04D_COD,1,2)
base$TECNO<-as.factor(base$TECNO)
base$car1<-as.factor(base$car1)
base$car2<-as.factor(base$car2)
base<-funcionesEPH::entra.cuchillo.salen.las.ramas(base)
return(base)
}
usu_individual_T421<-auxiliares(usu_individual_T421)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(here)
setwd(here())
usu_individual_T421 <- read.csv("EPH_usu_4_Trim_2021_txt/usu_individual_T421.txt", sep=";")
usu_individual_T421 %>% filter(ESTADO==1)->usu_individual_T421
auxiliares<-function(base){
base$d5<-as.numeric(substr(base$PP04D_COD,nchar(base$PP04D_COD),nchar(base$PP04D_COD)))
base$CALIFICACION<-as.numeric(substr(base$PP04D_COD,nchar(base$PP04D_COD),nchar(base$PP04D_COD)))
base$JERARQUIA<-as.numeric(substr(base$PP04D_COD,nchar(base$PP04D_COD)-2,nchar(base$PP04D_COD)-2))
# base$JERARQUIA<-ifelse(is.na(base$JERARQUIA), 0, base$JERARQUIA)
base$CALIFICACION<-as.factor(base$CALIFICACION)
base$JERARQUIA<-as.factor(base$JERARQUIA)
base %>%  mutate(rol = case_when(
ESTADO==1 & CAT_OCUP== 3 & (JERARQUIA==2 | JERARQUIA==0) ~  "Dirección",
ESTADO==1 & CAT_OCUP== 3 & JERARQUIA==3 & CALIFICACION==1 ~  "Profesional",
ESTADO==1 & CAT_OCUP== 3 & JERARQUIA==3 & CALIFICACION==2 ~  "tecnicos",
ESTADO==1 & CAT_OCUP== 3 & JERARQUIA==3 & CALIFICACION==3 ~  "operativos",
ESTADO==1 & CAT_OCUP== 3 & JERARQUIA==3 & CALIFICACION==4 ~  "Obrero NC",
ESTADO==1 & CAT_OCUP==2 & (NIVEL_ED==6 | NIVEL_ED==5) ~ "CP_calif",
ESTADO==1 & CAT_OCUP==2 & NIVEL_ED!=6 | NIVEL_ED!=5 ~ "CP_no_calif",
ESTADO==1 & CAT_OCUP== 1 ~ "Patron",
TRUE ~ "Otro"
))->base
base %>%  mutate(INF = case_when(
PP04C<6 & d5>1 & d5<6 & CAT_OCUP== 1  ~  "Patron INF",
PP04C>5 & (d5<1 | d5>=6) & CAT_OCUP== 1  ~  "Patron formal",
PP04C<6 & d5>1 & d5<6 & CAT_OCUP== 2  ~  "CP INF",
PP04C>5 & (d5<1 | d5>=6) & CAT_OCUP== 2  ~  "CP formal",
CAT_OCUP== 3 & PP07H==2 &  PP04C>5 & PP04B1==2  ~  "inf_for",
CAT_OCUP== 3 & PP07H==2 &  PP04C<6 & PP04B1==2 ~ "inf_inf",
CAT_OCUP== 3 & PP07H==2 & PP04B1==1 ~ "inf_hog",
CAT_OCUP== 3 & PP07H==1 & PP04B1==1 ~ "form_hog",
CAT_OCUP== 3 & PP07H==1 &  PP04C>5 & PP04B1==2   ~ "form_form",
CAT_OCUP== 3 & PP07H==1 &  PP04C<6 & PP04B1==2   ~ "form_inf"
))->base
base$CH03<-as.factor(base$CH03)
base$CAT_OCUP<-as.factor(base$CAT_OCUP)
base$NIVEL_ED<-as.factor(base$NIVEL_ED)
base$CH04<-as.factor(base$CH04)
base$AGLOMERADO<-as.factor(base$AGLOMERADO)
base$REGION<-as.factor(base$REGION)
base$INF<-as.factor(base$INF)
base$rol<-as.factor(base$rol)
base$PP04C<-as.factor(base$PP04C)
# base$CH06<-(base$CH06-min(base$CH06))/(max(base$CH06)- min(base$CH06))
base$TECNO<-substr(base$PP04D_COD,4,4)
base$car1<-substr(base$PP04D_COD,1,1)
base$car2<-substr(base$PP04D_COD,1,2)
base$TECNO<-as.factor(base$TECNO)
base$car1<-as.factor(base$car1)
base$car2<-as.factor(base$car2)
base<-funcionesEPH::entra.cuchillo.salen.las.ramas(base)
return(base)
}
usu_individual_T421<-auxiliares(usu_individual_T421)
usu_individual_T421 %>% group_by(CAT_OCUP) %>% summarise(n=n(),
no_respuesta=sum(P21==(-9)),
porcentaje=no_respuesta/n,
media=mean(P21))
usu_individual_T421 %>% filter(P21!=(-9) & P21>0)->baseAjustada
par(mfrow = c(1, 2))
hist(baseAjustada$P21, main = "Ingreso", col = "blue")
hist(log(baseAjustada$P21), main = "Logaritmo del ingreso", col = "green")
dx <- density(baseAjustada$P21)
usu_individual_T421 %>% filter(P21!=(-9) & P21>0)->baseAjustada
par(mfrow = c(1, 2))
dx <- density(baseAjustada$P21)
hist(baseAjustada$P21, main = "Ingreso", col = "blue")
lines(dx, lwd = 2, col = "red")
hist(log(baseAjustada$P21), main = "Logaritmo del ingreso", col = "green")
density(baseAjustada$P21)
usu_individual_T421 %>% filter(P21!=(-9) & P21>0)->baseAjustada
par(mfrow = c(1, 2))
# hist(baseAjustada$P21, main = "Ingreso", col = "blue")
# lines(dx, lwd = 2, col = "red")
plot(density(baseAjustada$P21))
hist(log(baseAjustada$P21), main = "Logaritmo del ingreso", col = "green")
usu_individual_T421 %>% filter(P21!=(-9) & P21>0)->baseAjustada
par(mfrow = c(1, 2))
# hist(baseAjustada$P21, main = "Ingreso", col = "blue")
# lines(dx, lwd = 2, col = "red")
plot(density(baseAjustada$P21))
plot(density(log(baseAjustada$P21)))
# hist(log(baseAjustada$P21), main = "Logaritmo del ingreso", col = "green")
# hist(baseAjustada$P21, main = "Ingreso", col = "blue")
# lines(dx, lwd = 2, col = "red")
plot(density(baseAjustada$P21), main="Ingreso", col="blue")
usu_individual_T421 %>% filter(P21!=(-9) & P21>0)->baseAjustada
par(mfrow = c(1, 2))
# hist(baseAjustada$P21, main = "Ingreso", col = "blue")
# lines(dx, lwd = 2, col = "red")
plot(density(baseAjustada$P21), main="Ingreso", col="blue")
plot(density(log(baseAjustada$P21)), main="Logaritmo del ingreso", col="green")
# hist(log(baseAjustada$P21), main = "Logaritmo del ingreso", col = "green")
?plot
shapiro.test(usu_individual_T421$P21)
shapiro.test(baseAjustada$P21)
library(nortest)
install.packages("nortest")
library(nortest)
ad.test(baseAjustada$P21)
ad.test(log(baseAjustada$P21))
#se obtiene el logaritmo de la P21
baseAjustada$Y <- log(baseAjustada$P21)
modelo <- lm( Y ~ INF + CH06*rol + CH04 +TOT_P12+ rama.eph+ car2+AGLOMERADO+INTENSI, data=baseAjustada )
usu_individual_T421 %>% filter(P21==(-9))->baseImp
# se genera la predicción a una base que tiene solo las variables que se toman en
# cuenta en el modelo y se agrega a la base original filtrada por la categoría ocupacional correspondiente
baseRL3$P21_predicho <- predict(modelo, baseImp)
# se genera la predicción a una base que tiene solo las variables que se toman en
# cuenta en el modelo y se agrega a la base original filtrada por la categoría ocupacional correspondiente
baseImp$P21_predicho <- predict(modelo, baseImp)
plot(modelo)
tidy_2 <- tidy(modelo2, conf.int = TRUE)
library(tidymodels)
tidy_2 <- tidy(modelo2, conf.int = TRUE)
tidy_2 <- tidy(modelo, conf.int = TRUE)
tidy_2%>%
knitr::kable(format = "html",
align = "lccrr",
caption = "Coeficientes modelo 2",
digits = 2) %>%
kable_material(lightable_options = c("striped", "hover") , html_font = "Cambria" )
library(knitr)
library(kableExtra)
tidy_2 <- tidy(modelo, conf.int = TRUE)
tidy_2%>%
knitr::kable(format = "html",
align = "lccrr",
caption = "Coeficientes modelo 2",
digits = 2) %>%
kable_material(lightable_options = c("striped", "hover") , html_font = "Cambria" )
usu_individual_T421$rama.eph
usu_individual_T421$rama.eph<-as.factor(usu_individual_T421$rama.eph)
View(tidy_2)
summary(modelo)
# se genera la predicción a una base que tiene solo las variables que se toman en
# cuenta en el modelo y se agrega a la base original filtrada por la categoría ocupacional correspondiente
baseImp$P21_predicho <- predict(modelo, baseImp)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(here)
library(knitr)
library(kableExtra)
setwd(here())
usu_individual_T421 <- read.csv("EPH_usu_4_Trim_2021_txt/usu_individual_T421.txt", sep=";")
usu_individual_T421 %>% filter(ESTADO==1)->usu_individual_T421
auxiliares<-function(base){
base$d5<-as.numeric(substr(base$PP04D_COD,nchar(base$PP04D_COD),nchar(base$PP04D_COD)))
base$CALIFICACION<-as.numeric(substr(base$PP04D_COD,nchar(base$PP04D_COD),nchar(base$PP04D_COD)))
base$JERARQUIA<-as.numeric(substr(base$PP04D_COD,nchar(base$PP04D_COD)-2,nchar(base$PP04D_COD)-2))
# base$JERARQUIA<-ifelse(is.na(base$JERARQUIA), 0, base$JERARQUIA)
base$CALIFICACION<-as.factor(base$CALIFICACION)
base$JERARQUIA<-as.factor(base$JERARQUIA)
base %>%  mutate(rol = case_when(
ESTADO==1 & CAT_OCUP== 3 & (JERARQUIA==2 | JERARQUIA==0) ~  "Dirección",
ESTADO==1 & CAT_OCUP== 3 & JERARQUIA==3 & CALIFICACION==1 ~  "Profesional",
ESTADO==1 & CAT_OCUP== 3 & JERARQUIA==3 & CALIFICACION==2 ~  "tecnicos",
ESTADO==1 & CAT_OCUP== 3 & JERARQUIA==3 & CALIFICACION==3 ~  "operativos",
ESTADO==1 & CAT_OCUP== 3 & JERARQUIA==3 & CALIFICACION==4 ~  "Obrero NC",
ESTADO==1 & CAT_OCUP==2 & (NIVEL_ED==6 | NIVEL_ED==5) ~ "CP_calif",
ESTADO==1 & CAT_OCUP==2 & NIVEL_ED!=6 | NIVEL_ED!=5 ~ "CP_no_calif",
ESTADO==1 & CAT_OCUP== 1 ~ "Patron",
TRUE ~ "Otro"
))->base
# base %>%  mutate(INF = case_when(
#   PP04C<6 & d5>1 & d5<6 & CAT_OCUP== 1  ~  "Patron INF",
#   PP04C>5 & (d5<1 | d5>=6) & CAT_OCUP== 1  ~  "Patron formal",
#   PP04C<6 & d5>1 & d5<6 & CAT_OCUP== 2  ~  "CP INF",
#   PP04C>5 & (d5<1 | d5>=6) & CAT_OCUP== 2  ~  "CP formal",
#   CAT_OCUP== 3 & PP07H==2 &  PP04C>5 & PP04B1==2  ~  "inf_for",
#   CAT_OCUP== 3 & PP07H==2 &  PP04C<6 & PP04B1==2 ~ "inf_inf",
#   CAT_OCUP== 3 & PP07H==2 & PP04B1==1 ~ "inf_hog",
#   CAT_OCUP== 3 & PP07H==1 & PP04B1==1 ~ "form_hog",
#   CAT_OCUP== 3 & PP07H==1 &  PP04C>5 & PP04B1==2   ~ "form_form",
#   CAT_OCUP== 3 & PP07H==1 &  PP04C<6 & PP04B1==2   ~ "form_inf"
#   ))->base
base %>%  mutate(INF = case_when(
PP04C<6 & d5>1 & d5<6 & CAT_OCUP== 1  ~  "Informal",
PP04C>5 & (d5<1 | d5>=6) & CAT_OCUP== 1  ~  "Formal",
PP04C<6 & d5>1 & d5<6 & CAT_OCUP== 2  ~  "Informal",
PP04C>5 & (d5<1 | d5>=6) & CAT_OCUP== 2  ~  "Formal",
CAT_OCUP== 3 & PP07H==2 &  PP04C>5 & PP04B1==2  ~  "Informal",
CAT_OCUP== 3 & PP07H==2 &  PP04C<6 & PP04B1==2 ~ "Informal",
CAT_OCUP== 3 & PP07H==2 & PP04B1==1 ~ "Informal",
CAT_OCUP== 3 & PP07H==1 & PP04B1==1 ~ "Formal",
CAT_OCUP== 3 & PP07H==1 &  PP04C>5 & PP04B1==2   ~ "Formal",
CAT_OCUP== 3 & PP07H==1 &  PP04C<6 & PP04B1==2   ~ "Formal"
))->base
base$CH03<-as.factor(base$CH03)
base$CAT_OCUP<-as.factor(base$CAT_OCUP)
base$NIVEL_ED<-as.factor(base$NIVEL_ED)
base$CH04<-as.factor(base$CH04)
base$AGLOMERADO<-as.factor(base$AGLOMERADO)
base$REGION<-as.factor(base$REGION)
base$INF<-as.factor(base$INF)
base$rol<-as.factor(base$rol)
base$PP04C<-as.factor(base$PP04C)
# base$CH06<-(base$CH06-min(base$CH06))/(max(base$CH06)- min(base$CH06))
base$TECNO<-substr(base$PP04D_COD,4,4)
base$car1<-substr(base$PP04D_COD,1,1)
base$car2<-substr(base$PP04D_COD,1,2)
base$TECNO<-as.factor(base$TECNO)
base$car1<-as.factor(base$car1)
base$car2<-as.factor(base$car2)
base<-funcionesEPH::entra.cuchillo.salen.las.ramas(base)
return(base)
}
usu_individual_T421<-auxiliares(usu_individual_T421)
usu_individual_T421$rama.eph<-as.factor(usu_individual_T421$rama.eph)
usu_individual_T421 %>% filter(P21!=(-9) & P21>0)->baseAjustada
par(mfrow = c(1, 2))
# hist(baseAjustada$P21, main = "Ingreso", col = "blue")
plot(density(baseAjustada$P21), main="Ingreso", col="blue")
plot(density(log(baseAjustada$P21)), main="Logaritmo del ingreso", col="green")
# hist(log(baseAjustada$P21), main = "Logaritmo del ingreso", col = "green")
baseAjustada$Y <- log(baseAjustada$P21)
modelo <- lm( Y ~ INF + CH06*rol + CH04 +TOT_P12+ rama.eph+ car2+AGLOMERADO+INTENSI, data=baseAjustada )
plot(modelo)
library(tidymodels)
tidy_2 <- tidy(modelo, conf.int = TRUE)
tidy_2%>%
knitr::kable(format = "html",
align = "lccrr",
caption = "Coeficientes modelo",
digits = 2) %>%
kable_material(lightable_options = c("striped", "hover") , html_font = "Cambria" )
summary(modelo)
```{r lm}
usu_individual_T421 %>% filter(P21==(-9))->baseImp
#se obtiene el logaritmo de la P21
baseAjustada$Y <- log(baseAjustada$P21)
modelo <- lm( Y ~ INF + CH06*rol + CH04 +TOT_P12+ rama.eph+ car2+AGLOMERADO+INTENSI, data=baseAjustada )
# se genera la predicción a una base que tiene solo las variables que se toman en
# cuenta en el modelo y se agrega a la base original filtrada por la categoría ocupacional correspondiente
baseImp$P21_predicho <- predict(modelo, baseImp)
modelo <- lm( Y ~ INF + CH06*rol + CH04 +TOT_P12+ rama.eph+ car1+AGLOMERADO+INTENSI, data=baseAjustada )
# se genera la predicción a una base que tiene solo las variables que se toman en
# cuenta en el modelo y se agrega a la base original filtrada por la categoría ocupacional correspondiente
baseImp$P21_predicho <- predict(modelo, baseImp)
View(baseImp)
# se genera la predicción a una base que tiene solo las variables que se toman en
# cuenta en el modelo y se agrega a la base original filtrada por la categoría ocupacional correspondiente
baseImp$P21_predicho <- exp(predict(modelo, baseImp))
View(baseImp)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(dplyr)
library(here)
library(knitr)
library(kableExtra)
setwd(here())
source("funciones/funciones.r")
usu_individual_T421 <- read.csv("EPH_usu_2do_Trim_2022_txt/usu_individual_T222.txt", sep=";")
usu_individual_T222.txt <- read.csv("C:/Users/lnfernandez/Desktop/posgrado/Enfoque estadístico del aprendizaje/TP 2/EPH_usu_2do_Trim_2022_txt/usu_individual_T222.txt.txt", sep=";")
View(usu_individual_T222.txt)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(here)
library(knitr)
library(kableExtra)
setwd(here())
source("funciones/funciones.r")
usu_individual_T421 <- read.csv("EPH_usu_2do_Trim_2022_txt/usu_individual_T222.txt.txt", sep=";")
usu_individual_T421 %>% filter(ESTADO==1 & CAT_OCUP==3)->usu_individual_T421
auxiliares<-function(base){
base$d5<-as.numeric(substr(base$PP04D_COD,nchar(base$PP04D_COD),nchar(base$PP04D_COD)))
base$CALIFICACION<-as.numeric(substr(base$PP04D_COD,nchar(base$PP04D_COD),nchar(base$PP04D_COD)))
base$JERARQUIA<-as.numeric(substr(base$PP04D_COD,nchar(base$PP04D_COD)-2,nchar(base$PP04D_COD)-2))
# base$JERARQUIA<-ifelse(is.na(base$JERARQUIA), 0, base$JERARQUIA)
base$CALIFICACION<-as.factor(base$CALIFICACION)
base$JERARQUIA<-as.factor(base$JERARQUIA)
base %>%  mutate(rol = case_when(
ESTADO==1 & CAT_OCUP== 3 & (JERARQUIA==2 | JERARQUIA==0) ~  "Dirección",
ESTADO==1 & CAT_OCUP== 3 & JERARQUIA==3 & CALIFICACION==1 ~  "Profesional",
ESTADO==1 & CAT_OCUP== 3 & JERARQUIA==3 & CALIFICACION==2 ~  "tecnicos",
ESTADO==1 & CAT_OCUP== 3 & JERARQUIA==3 & CALIFICACION==3 ~  "operativos",
ESTADO==1 & CAT_OCUP== 3 & JERARQUIA==3 & CALIFICACION==4 ~  "Obrero NC",
TRUE ~ "Otro"
))->base
base %>%  mutate(INF = case_when(
CAT_OCUP== 3 & PP07H==2 &  PP04C>5 & PP04B1==2  ~  "Informal",
CAT_OCUP== 3 & PP07H==2 &  PP04C<6 & PP04B1==2 ~ "Informal",
CAT_OCUP== 3 & PP07H==2 & PP04B1==1 ~ "Informal",
CAT_OCUP== 3 & PP07H==1 & PP04B1==1 ~ "Formal",
CAT_OCUP== 3 & PP07H==1 &  PP04C>5 & PP04B1==2   ~ "Formal",
CAT_OCUP== 3 & PP07H==1 &  PP04C<6 & PP04B1==2   ~ "Formal"
))->base
base$CH03<-as.factor(base$CH03)
base$CAT_OCUP<-as.factor(base$CAT_OCUP)
base$NIVEL_ED<-as.factor(base$NIVEL_ED)
base$CH04<-as.factor(base$CH04)
base$AGLOMERADO<-as.factor(base$AGLOMERADO)
base$REGION<-as.factor(base$REGION)
base$INF<-as.factor(base$INF)
base$rol<-as.factor(base$rol)
base$PP04C<-as.factor(base$PP04C)
# base$CH06<-(base$CH06-min(base$CH06))/(max(base$CH06)- min(base$CH06))
base$TECNO<-substr(base$PP04D_COD,4,4)
base$car1<-substr(base$PP04D_COD,1,1)
base$car2<-substr(base$PP04D_COD,1,2)
base$TECNO<-as.factor(base$TECNO)
base$car1<-as.factor(base$car1)
base$car2<-as.factor(base$car2)
base<-entra.cuchillo.salen.las.ramas(base)
return(base)
}
usu_individual_T421<-auxiliares(usu_individual_T421)
usu_individual_T421$rama.eph<-as.factor(usu_individual_T421$rama.eph)
usu_individual_T421 %>% group_by(rol) %>% summarise(n=n(),
no_respuesta=sum(P21==(-9)),
porcentaje=no_respuesta/n,
media=mean(P21))->roles
roles[sort(roles$media)]
usu_individual_T421 %>% group_by(rol) %>% summarise(n=n(),
no_respuesta=sum(P21==(-9)),
porcentaje=no_respuesta/n,
media=mean(P21))->roles
roles[sort(roles$media),]->roles
roles %>%
knitr::kable(format = "html",
align = "lccrr",
caption = "No respuesta y media del ingreso según rol",
digits = 2) %>%
kable_material(lightable_options = c("striped", "hover") , html_font = "Cambria" )
cor.test(roles$porcentaje, roles$media, method = "spearman")
usu_individual_T421 %>% group_by(rol) %>% summarise(n=n(),
no_respuesta=sum(P21==(-9)),
porcentaje=no_respuesta/n,
media=mean(P21))->roles
roles[sort(roles$media),]->roles
roles %>%
knitr::kable(format = "html",
align = "lccrr",
caption = "No respuesta y media del ingreso según rol",
digits = 2) %>%
kable_material(lightable_options = c("striped", "hover") , html_font = "Cambria" )
cor.test(roles$porcentaje, roles$media, method = "spearman")
cor.test(roles$porcentaje, roles$media, method = "spearman")
usu_individual_T421 %>% group_by(CH04) %>% summarise(n=n(),
no_respuesta=sum(P21==(-9)),
porcentaje=no_respuesta/n,
media=mean(P21))->sexo
sexo%>%
knitr::kable(format = "html",
align = "lccrr",
caption = "No respuesta y media del ingreso según sexo",
digits = 2) %>%
kable_material(lightable_options = c("striped", "hover") , html_font = "Cambria" )
cor.test(sexo$porcentaje, sexo$media, method = "spearman")
usu_individual_T421 %>% group_by(INTENSI) %>% summarise(n=n(),
no_respuesta=sum(P21==(-9)),
porcentaje=no_respuesta/n,
media=mean(P21))->intensidad
intensidad$INTENSI<-c("Subocupado",
"Ocupado",
"Sobreocupado",
"Ocupado que no trabajó en la
semana "
)
intensidad[sort(intensidad$media),]->intensidad
intensidad%>%
knitr::kable(format = "html",
align = "lccrr",
caption = "No respuesta y media del ingreso según intensidad laboral",
digits = 2) %>%
kable_material(lightable_options = c("striped", "hover") , html_font = "Cambria" )
cor.test(intensidad$porcentaje, intensidad$media, method = "spearman")
View(intensidad)
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(here)
library(knitr)
library(kableExtra)
setwd(here())
source("funciones/funciones.r")
usu_individual_T421 <- read.csv("EPH_usu_2do_Trim_2022_txt/usu_individual_T222.txt.txt", sep=";")
usu_individual_T421 %>% filter(ESTADO==1 & CAT_OCUP==3)->usu_individual_T421
auxiliares<-function(base){
base$d5<-as.numeric(substr(base$PP04D_COD,nchar(base$PP04D_COD),nchar(base$PP04D_COD)))
base$CALIFICACION<-as.numeric(substr(base$PP04D_COD,nchar(base$PP04D_COD),nchar(base$PP04D_COD)))
base$JERARQUIA<-as.numeric(substr(base$PP04D_COD,nchar(base$PP04D_COD)-2,nchar(base$PP04D_COD)-2))
# base$JERARQUIA<-ifelse(is.na(base$JERARQUIA), 0, base$JERARQUIA)
base$CALIFICACION<-as.factor(base$CALIFICACION)
base$JERARQUIA<-as.factor(base$JERARQUIA)
base %>%  mutate(rol = case_when(
ESTADO==1 & CAT_OCUP== 3 & (JERARQUIA==2 | JERARQUIA==0) ~  "Dirección",
ESTADO==1 & CAT_OCUP== 3 & JERARQUIA==3 & CALIFICACION==1 ~  "Profesional",
ESTADO==1 & CAT_OCUP== 3 & JERARQUIA==3 & CALIFICACION==2 ~  "tecnicos",
ESTADO==1 & CAT_OCUP== 3 & JERARQUIA==3 & CALIFICACION==3 ~  "operativos",
ESTADO==1 & CAT_OCUP== 3 & JERARQUIA==3 & CALIFICACION==4 ~  "Obrero NC",
TRUE ~ "Otro"
))->base
base %>%  mutate(INF = case_when(
CAT_OCUP== 3 & PP07H==2 &  PP04C>5 & PP04B1==2  ~  "Informal",
CAT_OCUP== 3 & PP07H==2 &  PP04C<6 & PP04B1==2 ~ "Informal",
CAT_OCUP== 3 & PP07H==2 & PP04B1==1 ~ "Informal",
CAT_OCUP== 3 & PP07H==1 & PP04B1==1 ~ "Formal",
CAT_OCUP== 3 & PP07H==1 &  PP04C>5 & PP04B1==2   ~ "Formal",
CAT_OCUP== 3 & PP07H==1 &  PP04C<6 & PP04B1==2   ~ "Formal"
))->base
base$CH03<-as.factor(base$CH03)
base$CAT_OCUP<-as.factor(base$CAT_OCUP)
base$NIVEL_ED<-as.factor(base$NIVEL_ED)
base$CH04<-as.factor(base$CH04)
base$AGLOMERADO<-as.factor(base$AGLOMERADO)
base$REGION<-as.factor(base$REGION)
base$INF<-as.factor(base$INF)
base$rol<-as.factor(base$rol)
base$PP04C<-as.factor(base$PP04C)
# base$CH06<-(base$CH06-min(base$CH06))/(max(base$CH06)- min(base$CH06))
base$TECNO<-substr(base$PP04D_COD,4,4)
base$car1<-substr(base$PP04D_COD,1,1)
base$car2<-substr(base$PP04D_COD,1,2)
base$TECNO<-as.factor(base$TECNO)
base$car1<-as.factor(base$car1)
base$car2<-as.factor(base$car2)
base<-entra.cuchillo.salen.las.ramas(base)
return(base)
}
usu_individual_T421<-auxiliares(usu_individual_T421)
usu_individual_T421$rama.eph<-as.factor(usu_individual_T421$rama.eph)
usu_individual_T421 %>% group_by(rol) %>% summarise(n=n(),
no_respuesta=sum(P21==(-9)),
porcentaje=no_respuesta/n,
media=mean(P21))->roles
roles[sort(roles$media),]->roles
roles %>%
knitr::kable(format = "html",
align = "lccrr",
caption = "No respuesta y media del ingreso según rol",
digits = 2) %>%
kable_material(lightable_options = c("striped", "hover") , html_font = "Cambria" )
View(roles)
View(usu_individual_T421)
usu_individual_T421 %>% group_by(rol) %>% summarise(n=n(),
no_respuesta=sum(P21==(-9)),
porcentaje=no_respuesta/n,
media=mean(P21))->roles
View(roles)
roles[sort(roles$media),]->roles
View(roles)
```{r s_rol}
usu_individual_T421 %>% group_by(rol) %>% summarise(n=n(),
no_respuesta=sum(P21==(-9)),
porcentaje=no_respuesta/n,
media=mean(P21))->roles
roles[order(roles$media),]->roles
View(roles)
cor.test(intensidad$porcentaje, intensidad$media, method = "spearman")$estimate
cor.test(intensidad$porcentaje, intensidad$media, method = "spearman")
usu_individual_T421 %>% group_by(INTENSI) %>% summarise(n=n(),
no_respuesta=sum(P21==(-9)),
porcentaje=no_respuesta/n,
media=mean(P21))->intensidad
intensidad$INTENSI<-c("Subocupado",
"Ocupado",
"Sobreocupado",
"Ocupado que no trabajó en la
semana "
)
intensidad[order(intensidad$media),]->intensidad
intensidad%>%
knitr::kable(format = "html",
align = "lccrr",
caption = "No respuesta y media del ingreso según intensidad laboral",
digits = 2) %>%
kable_material(lightable_options = c("striped", "hover") , html_font = "Cambria" )
cor.test(intensidad$porcentaje, intensidad$media, method = "spearman")
cor.test(intensidad$porcentaje, intensidad$media, method = "spearman")$estimate
library(ltm)
install.packages("ltm")
cor.test(intensidad$porcentaje, intensidad$INTENSI, method = "spearman")
